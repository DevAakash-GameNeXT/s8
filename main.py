import asyncio
import csv
import os
from playwright.async_api import async_playwright

LIST =['https://www.facebook.com/61573019363825/', 'https://www.facebook.com/61573057981692/', 'https://www.facebook.com/61573058113768/', 'https://www.facebook.com/61573059173251/', 'https://www.facebook.com/61573068564402/', 'https://www.facebook.com/61573071339735/', 'https://www.facebook.com/61573072973927/', 'https://www.facebook.com/61573078490713/', 'https://www.facebook.com/61573108610738/', 'https://www.facebook.com/61573108794282/', 'https://www.facebook.com/61573114896232/', 'https://www.facebook.com/61573135623740/', 'https://www.facebook.com/61573138125938/', 'https://www.facebook.com/61573152245857/', 'https://www.facebook.com/61573160246722/', 'https://www.facebook.com/61573168052433/', 'https://www.facebook.com/61573169395289/', 'https://www.facebook.com/61573176413248/', 'https://www.facebook.com/61573184141240/', 'https://www.facebook.com/61573190626558/', 'https://www.facebook.com/61573191024261/', 'https://www.facebook.com/61573286644456/', 'https://www.facebook.com/61573304637434/', 'https://www.facebook.com/61573325582776/', 'https://www.facebook.com/61573340621196/', 'https://www.facebook.com/61573374082016/', 'https://www.facebook.com/61573393450186/', 'https://www.facebook.com/61573401815502/', 'https://www.facebook.com/61573407607482/', 'https://www.facebook.com/61573418357807/', 'https://www.facebook.com/61573423622907/', 'https://www.facebook.com/61573430330101/', 'https://www.facebook.com/61573435423076/', 'https://www.facebook.com/61573458149752/', 'https://www.facebook.com/61573464820287/', 'https://www.facebook.com/61573502282516/', 'https://www.facebook.com/61573505472476/', 'https://www.facebook.com/61573506759865/', 'https://www.facebook.com/61573510454504/', 'https://www.facebook.com/61573524672026/', 'https://www.facebook.com/61573526395219/', 'https://www.facebook.com/61573529756293/', 'https://www.facebook.com/61573536263807/', 'https://www.facebook.com/61573548098649/', 'https://www.facebook.com/61573555883551/', 'https://www.facebook.com/61573563921603/', 'https://www.facebook.com/61573564383079/', 'https://www.facebook.com/61573581384561/', 'https://www.facebook.com/61573584530263/', 'https://www.facebook.com/61573586862100/', 'https://www.facebook.com/61573591403838/', 'https://www.facebook.com/61573610409045/', 'https://www.facebook.com/61573613498436/', 'https://www.facebook.com/61573643709621/', 'https://www.facebook.com/61573677009784/', 'https://www.facebook.com/61573686011858/', 'https://www.facebook.com/61573691501168/', 'https://www.facebook.com/61573695174296/', 'https://www.facebook.com/61573696239435/', 'https://www.facebook.com/61573697885168/', 'https://www.facebook.com/61573698873277/', 'https://www.facebook.com/61573706220308/', 'https://www.facebook.com/61573725311980/', 'https://www.facebook.com/61573729015310/', 'https://www.facebook.com/61573732346179/', 'https://www.facebook.com/61573735565547/', 'https://www.facebook.com/61573746723504/', 'https://www.facebook.com/61573748863952/', 'https://www.facebook.com/61573753064421/', 'https://www.facebook.com/61573757047621/', 'https://www.facebook.com/61573770723405/', 'https://www.facebook.com/61573775044326/', 'https://www.facebook.com/61573775158388/', 'https://www.facebook.com/61573785932099/', 'https://www.facebook.com/61573789940851/', 'https://www.facebook.com/61573790725910/', 'https://www.facebook.com/61573794088271/', 'https://www.facebook.com/61573804534741/', 'https://www.facebook.com/61573815639623/', 'https://www.facebook.com/61573822964086/', 'https://www.facebook.com/61573830706832/', 'https://www.facebook.com/61573845765744/', 'https://www.facebook.com/61573855558465/', 'https://www.facebook.com/61573859859180/', 'https://www.facebook.com/61573860116628/', 'https://www.facebook.com/61573864593484/', 'https://www.facebook.com/61573900629310/', 'https://www.facebook.com/61573905177583/', 'https://www.facebook.com/61573908997992/', 'https://www.facebook.com/61573920140835/', 'https://www.facebook.com/61573924302153/', 'https://www.facebook.com/61573946015020/', 'https://www.facebook.com/61573950303737/', 'https://www.facebook.com/61573957952224/', 'https://www.facebook.com/61573959066554/', 'https://www.facebook.com/61573970604001/', 'https://www.facebook.com/61573976545091/', 'https://www.facebook.com/61573984829494/', 'https://www.facebook.com/61574005287426/', 'https://www.facebook.com/61574012864376/', 'https://www.facebook.com/61574018249353/', 'https://www.facebook.com/61574020449831/', 'https://www.facebook.com/61574032652346/', 'https://www.facebook.com/61574037272616/', 'https://www.facebook.com/61574068743888/', 'https://www.facebook.com/61574091113971/', 'https://www.facebook.com/61574092648388/', 'https://www.facebook.com/61574096106255/', 'https://www.facebook.com/61574099966510/', 'https://www.facebook.com/61574126770727/', 'https://www.facebook.com/61574134747011/', 'https://www.facebook.com/61574138218789/', 'https://www.facebook.com/61574140140593/', 'https://www.facebook.com/61574140619485/', 'https://www.facebook.com/61574140733109/', 'https://www.facebook.com/61574144813364/', 'https://www.facebook.com/61574148790094/', 'https://www.facebook.com/61574152954659/', 'https://www.facebook.com/61574155233688/', 'https://www.facebook.com/61574163114834/', 'https://www.facebook.com/61574169791968/', 'https://www.facebook.com/61574183279017/', 'https://www.facebook.com/61574190232038/', 'https://www.facebook.com/61574199645206/', 'https://www.facebook.com/61574200785149/', 'https://www.facebook.com/61574206240232/', 'https://www.facebook.com/61574209543791/', 'https://www.facebook.com/61574214300521/', 'https://www.facebook.com/61574223801681/', 'https://www.facebook.com/61574239405157/', 'https://www.facebook.com/61574250862346/', 'https://www.facebook.com/61574403402395/', 'https://www.facebook.com/61574414277413/', 'https://www.facebook.com/61574415704265/', 'https://www.facebook.com/61574416268470/', 'https://www.facebook.com/61574424437939/', 'https://www.facebook.com/61574445892271/', 'https://www.facebook.com/61574446238826/', 'https://www.facebook.com/61574453532448/', 'https://www.facebook.com/61574454364284/', 'https://www.facebook.com/61574457657053/', 'https://www.facebook.com/61574458516647/', 'https://www.facebook.com/61574486081350/', 'https://www.facebook.com/61574486773697/', 'https://www.facebook.com/61574494753836/', 'https://www.facebook.com/61574520931100/', 'https://www.facebook.com/61574525412066/', 'https://www.facebook.com/61574528416875/', 'https://www.facebook.com/61574530145286/', 'https://www.facebook.com/61574533936662/', 'https://www.facebook.com/61574542752833/', 'https://www.facebook.com/61574549621900/', 'https://www.facebook.com/61574574782973/', 'https://www.facebook.com/61574580311837/', 'https://www.facebook.com/61574584975834/', 'https://www.facebook.com/61574587312569/', 'https://www.facebook.com/61574591559270/', 'https://www.facebook.com/61574596469033/', 'https://www.facebook.com/61574600500610/', 'https://www.facebook.com/61574615245094/', 'https://www.facebook.com/61574616433780/', 'https://www.facebook.com/61574639832951/', 'https://www.facebook.com/61574642043694/', 'https://www.facebook.com/61574644233318/', 'https://www.facebook.com/61574645735977/', 'https://www.facebook.com/61574652052922/', 'https://www.facebook.com/61574664770535/', 'https://www.facebook.com/61574665937417/', 'https://www.facebook.com/61574668843002/', 'https://www.facebook.com/61574668966022/', 'https://www.facebook.com/61574675483323/', 'https://www.facebook.com/61574675909010/', 'https://www.facebook.com/61574680625243/', 'https://www.facebook.com/61574685070077/', 'https://www.facebook.com/61574702684634/', 'https://www.facebook.com/61574727670511/', 'https://www.facebook.com/61574757877531/', 'https://www.facebook.com/61574761945464/', 'https://www.facebook.com/61574766036709/', 'https://www.facebook.com/61574766991203/', 'https://www.facebook.com/61574771535238/', 'https://www.facebook.com/61574771998283/', 'https://www.facebook.com/61574774492360/', 'https://www.facebook.com/61574781356330/', 'https://www.facebook.com/61574784597506/', 'https://www.facebook.com/61574793397189/', 'https://www.facebook.com/61574815748930/', 'https://www.facebook.com/61574816614765/', 'https://www.facebook.com/61574818709262/', 'https://www.facebook.com/61574818945784/', 'https://www.facebook.com/61574821197522/', 'https://www.facebook.com/61574822933481/', 'https://www.facebook.com/61574825251224/', 'https://www.facebook.com/61574827168353/', 'https://www.facebook.com/61574831350787/', 'https://www.facebook.com/61574838807513/', 'https://www.facebook.com/61574840141593/', 'https://www.facebook.com/61574842207528/', 'https://www.facebook.com/61574846407670/', 'https://www.facebook.com/61574848045898/', 'https://www.facebook.com/61574849515095/', 'https://www.facebook.com/61574850278624/', 'https://www.facebook.com/61574857589611/', 'https://www.facebook.com/61574858019110/', 'https://www.facebook.com/61574859980706/', 'https://www.facebook.com/61574860046294/', 'https://www.facebook.com/61574870826554/', 'https://www.facebook.com/61574871609318/', 'https://www.facebook.com/61574874459345/', 'https://www.facebook.com/61574875179919/', 'https://www.facebook.com/61574881291776/', 'https://www.facebook.com/61574886659157/', 'https://www.facebook.com/61574886789448/', 'https://www.facebook.com/61574890838832/', 'https://www.facebook.com/61574893011328/', 'https://www.facebook.com/61574895774739/', 'https://www.facebook.com/61574895993668/', 'https://www.facebook.com/61574905821153/', 'https://www.facebook.com/61574911078344/', 'https://www.facebook.com/61574911292876/', 'https://www.facebook.com/61574911325568/', 'https://www.facebook.com/61574925276550/', 'https://www.facebook.com/61574925873603/', 'https://www.facebook.com/61574930278280/', 'https://www.facebook.com/61574954427445/', 'https://www.facebook.com/61574959114475/', 'https://www.facebook.com/61574968290738/', 'https://www.facebook.com/61574968892431/', 'https://www.facebook.com/61574976332970/', 'https://www.facebook.com/61574990882304/', 'https://www.facebook.com/61574992494422/', 'https://www.facebook.com/61574992648163/', 'https://www.facebook.com/61575003747591/', 'https://www.facebook.com/61575004975286/', 'https://www.facebook.com/61575006050178/', 'https://www.facebook.com/61575010710311/', 'https://www.facebook.com/61575040621266/', 'https://www.facebook.com/61575044970323/', 'https://www.facebook.com/61575046043986/', 'https://www.facebook.com/61575046342426/', 'https://www.facebook.com/61575059278542/', 'https://www.facebook.com/61575061136291/', 'https://www.facebook.com/61575066718180/', 'https://www.facebook.com/61575077150628/', 'https://www.facebook.com/61575077270006/', 'https://www.facebook.com/61575084328099/', 'https://www.facebook.com/61575094045979/', 'https://www.facebook.com/61575095123068/', 'https://www.facebook.com/61575097018301/', 'https://www.facebook.com/61575107633989/', 'https://www.facebook.com/61575145466130/', 'https://www.facebook.com/61575147175984/', 'https://www.facebook.com/61575147593054/', 'https://www.facebook.com/61575150353270/', 'https://www.facebook.com/61575170570786/', 'https://www.facebook.com/61575207982463/', 'https://www.facebook.com/61575220762124/', 'https://www.facebook.com/61575221992191/', 'https://www.facebook.com/61575236152010/', 'https://www.facebook.com/643699189304710', 'https://www.facebook.com/7squareinteriordesign/', 'https://www.facebook.com/91Astrology/', 'https://www.facebook.com/99GraphicsDesign/', 'https://www.facebook.com/A.T.RajkumarsMind/', 'https://www.facebook.com/A4agriculture-609694365560864/', 'https://www.facebook.com/AAAClubAlliance/', 'https://www.facebook.com/AARADHYA-COLLEGE-OF-EDUCATION-PVTLTD-608591652318900/', 'https://www.facebook.com/ACTE.in/', 'https://www.facebook.com/ACTIVE-TECHNICIAN-ENTERPRISE-176054358921518/', 'https://www.facebook.com/AEserver/', 'https://www.facebook.com/AIIXXOfficial/', 'https://www.facebook.com/AKJINDALCOMPUTERACCOUNTANCY/', 'https://www.facebook.com/AMRSumangaleeJewellers/', 'https://www.facebook.com/APS-THREEAI-457469417442466/', 'https://www.facebook.com/AYANAKomodo/', 'https://www.facebook.com/AYJSolicitors/', 'https://www.facebook.com/AbhishekPalPage/', 'https://www.facebook.com/AbundancewithEnglish/', 'https://www.facebook.com/Acodez/', 'https://www.facebook.com/AdobeExperienceCloud/', 'https://www.facebook.com/Adv-Vivaan-Lathwal-102231856271244/', 'https://www.facebook.com/AedasDesign/', 'https://www.facebook.com/AgriRouteIN/', 'https://www.facebook.com/AgritecAfricaRadeecal/', 'https://www.facebook.com/AlkemyEdTech/', 'https://www.facebook.com/AllianceUniOfcl/', 'https://www.facebook.com/Allsolutionmediaa/', 'https://www.facebook.com/AmericanChemicalSociety/', 'https://www.facebook.com/Ammar-Pokar-381562735048244/', 'https://www.facebook.com/AnupSonawane14/', 'https://www.facebook.com/Anuraguniversity/', 'https://www.facebook.com/AparnaGroup/', 'https://www.facebook.com/ApeejayStyaUniv/', 'https://www.facebook.com/AppinOfficial/', 'https://www.facebook.com/ArroboticsIndia/', 'https://www.facebook.com/AshcorpTechnologies/', 'https://www.facebook.com/Ashwani-Chaudhary-623326761646105/', 'https://www.facebook.com/AssureAI/', 'https://www.facebook.com/AuthkeyCpaaS/', 'https://www.facebook.com/AutomaticPaymentPools/', 'https://www.facebook.com/AvaommeSoftware/', 'https://www.facebook.com/Aviation-Institute-of-Management-281857835007791/', 'https://www.facebook.com/BIGBANKSIGNALS/', 'https://www.facebook.com/BSads1128/', 'https://www.facebook.com/BalajiWorld1/', 'https://www.facebook.com/BazaarX.co/', 'https://www.facebook.com/Bharat-Computer-Centre-124788844045604/', 'https://www.facebook.com/BhartiyaGroupofEducationInstitutions/', 'https://www.facebook.com/BigC777/', 'https://www.facebook.com/Bigbasketcom/', 'https://www.facebook.com/BlackstoneTaxConsultancy/', 'https://www.facebook.com/BlogAprendeyEmprende/', 'https://www.facebook.com/BlueManFamily/', 'https://www.facebook.com/Bmsmoney/', 'https://www.facebook.com/BookPublisherTools/', 'https://www.facebook.com/BrandMedix/', 'https://www.facebook.com/Brandtorque/', 'https://www.facebook.com/BreatheEasyChestHospital/', 'https://www.facebook.com/Brinc.io/', 'https://www.facebook.com/BuddhiClinic/', 'https://www.facebook.com/CHAPTER1.FINANCE/', 'https://www.facebook.com/CIMSMedicalRecruitmentIndia/', 'https://www.facebook.com/CINNOXHQ/', 'https://www.facebook.com/CRMAutomates/', 'https://www.facebook.com/CVILIANZ/', 'https://www.facebook.com/Candypopinteractive/', 'https://www.facebook.com/CareerCampusEdtech/', 'https://www.facebook.com/Carteruniquegroup/', 'https://www.facebook.com/CasagrandElysium/', 'https://www.facebook.com/CatoNetworks/', 'https://www.facebook.com/CelestialInstitute/', 'https://www.facebook.com/CentricityWealthTech/', 'https://www.facebook.com/CenturyPlyOfficial/', 'https://www.facebook.com/Chackochen-J-Plathottam-104080935320348/', 'https://www.facebook.com/ChampFitness01/', 'https://www.facebook.com/ChoiceHQ/', 'https://www.facebook.com/CloudPano/', 'https://www.facebook.com/Code-Care-Technology-110546278790178/', 'https://www.facebook.com/Codenera2020/', 'https://www.facebook.com/CodingForEeveryone/', 'https://www.facebook.com/Companymitra/', 'https://www.facebook.com/ComplianceEase/', 'https://www.facebook.com/Confident-Rera-Services-444947755361763/', 'https://www.facebook.com/ConverseIQ/', 'https://www.facebook.com/CreativeConsultingTI/', 'https://www.facebook.com/Credential-584059781463908/', 'https://www.facebook.com/CromaCampusNoidaOfficial/', 'https://www.facebook.com/CrystalOpportune/', 'https://www.facebook.com/Cvent/', 'https://www.facebook.com/CyberFrat/', 'https://www.facebook.com/CyclonePoultry/', 'https://www.facebook.com/DACdevelopersChennai/', 'https://www.facebook.com/DPM-ENTERPRISE-PRIVATE-LIMITED-531046303424181/', 'https://www.facebook.com/DarveshClassesFatehabad/', 'https://www.facebook.com/DeakinGIFTCityCampus/', 'https://www.facebook.com/DealHub.io/', 'https://www.facebook.com/DeepanshuSinghofficial/', 'https://www.facebook.com/DesignElementary/', 'https://www.facebook.com/DhanukaAgritechLtd/', 'https://www.facebook.com/DigidaraTechnologies/', 'https://www.facebook.com/Digiloans2025/', 'https://www.facebook.com/DigitalSupportKerala/', 'https://www.facebook.com/DigitalSuvidhaAgency/', 'https://www.facebook.com/Digitalshagun/', 'https://www.facebook.com/Divine.Blessings99/', 'https://www.facebook.com/Diw.digital/', 'https://www.facebook.com/DotMikSoftware/', 'https://www.facebook.com/DoubleKlick/', 'https://www.facebook.com/DoveSoftLtd/', 'https://www.facebook.com/Dr.puransharmaofficial/', 'https://www.facebook.com/DronaHQ.MobileApps/', 'https://www.facebook.com/Earendil.in/', 'https://www.facebook.com/EdTechInnovatePvtLtd/', 'https://www.facebook.com/Edmerito/', 'https://www.facebook.com/EducationLearningCommunity/', 'https://www.facebook.com/Educationbusiness1/', 'https://www.facebook.com/Eduonix/', 'https://www.facebook.com/EmiproTechnologies/', 'https://www.facebook.com/Enterprise11ss/', 'https://www.facebook.com/EntriApp.Tamil/', 'https://www.facebook.com/FUNNY1209/', 'https://www.facebook.com/FastCompany/', 'https://www.facebook.com/Finnzu-Ventures-623353007523836/', 'https://www.facebook.com/FirstPropertyOfficial/', 'https://www.facebook.com/FitterYouGurgaon/', 'https://www.facebook.com/Flexmaster.00/', 'https://www.facebook.com/FlyworldMigration/', 'https://www.facebook.com/Fonadaa/', 'https://www.facebook.com/Foodventure.inc/', 'https://www.facebook.com/FortuneMagazine/', 'https://www.facebook.com/FranklinTempletonIndia/', 'https://www.facebook.com/GACMotorNepal/', 'https://www.facebook.com/GEMSBSchool/', 'https://www.facebook.com/GOJO-TRADERS-130319166840559/', 'https://www.facebook.com/GTECKSD/', 'https://www.facebook.com/GWTLABS/', 'https://www.facebook.com/GeekTechnologyIndia/', 'https://www.facebook.com/Ghar-Ho-To-Aisa-567836116406766/', 'https://www.facebook.com/Godhjansewafoundation/', 'https://www.facebook.com/Goosebumps.store/', 'https://www.facebook.com/HCLSW/', 'https://www.facebook.com/HOGInternationalPreSchool/', 'https://www.facebook.com/Hamrash-Abdul-Sathar-638224912702578/', 'https://www.facebook.com/Handpickedkickstarterprojects/', 'https://www.facebook.com/HappyGroupAHM/', 'https://www.facebook.com/HappyMentorClinic/', 'https://www.facebook.com/HardwynGroupofficial/', 'https://www.facebook.com/HarmanProIndia.APAC/', 'https://www.facebook.com/Harsh-Garg-Sidhi-Consultant-581907245011970/', 'https://www.facebook.com/Harsirlatech/', 'https://www.facebook.com/HawkMultimedia7/', 'https://www.facebook.com/Healthein/', 'https://www.facebook.com/Herbovive21/', 'https://www.facebook.com/HergunAgritech/', 'https://www.facebook.com/HindustanControlSystem/', 'https://www.facebook.com/Hstarsgroup/', 'https://www.facebook.com/ICICIBankforBusiness/', 'https://www.facebook.com/ICIT-COMPUTER-EDUCATION-336972736162733/', 'https://www.facebook.com/IGCentre/', 'https://www.facebook.com/IIDIncubator/', 'https://www.facebook.com/IILTOfficial/', 'https://www.facebook.com/INNOVATIONMEDIANY/', 'https://www.facebook.com/ISBeduOnline/', 'https://www.facebook.com/IT-Urbanpro-Technologies-205223809348328/', 'https://www.facebook.com/ITMSkillsAcademy/', 'https://www.facebook.com/ITTRAINING.MEHSANA/', 'https://www.facebook.com/ITasCode.in/', 'https://www.facebook.com/IVYKPHB/', 'https://www.facebook.com/IamDigitalChandu/', 'https://www.facebook.com/ImarticusLearning/', 'https://www.facebook.com/ImpetusAIsolutions/', 'https://www.facebook.com/IncredMoney/', 'https://www.facebook.com/IndiaBondsOfficial/', 'https://www.facebook.com/Indiamarketoperatorofficial/', 'https://www.facebook.com/IndieByIndusIndBank/', 'https://www.facebook.com/IndomachExhibition/', 'https://www.facebook.com/IndusValleyPublicSchoolNoida62/', 'https://www.facebook.com/Infosys/', 'https://www.facebook.com/IntelliMarketSolution/', 'https://www.facebook.com/InvictaCareerConsultancy/', 'https://www.facebook.com/Invoay/', 'https://www.facebook.com/Jamnagaronlinemarketing/', 'https://www.facebook.com/Jay.awtani.JT/', 'https://www.facebook.com/JecrcUniversity/', 'https://www.facebook.com/JetkingWakadChinchwad/', 'https://www.facebook.com/Jodopay/', 'https://www.facebook.com/JoinFinGrad/', 'https://www.facebook.com/KaldaCosmeticAndHairTransplantationHospital/', 'https://www.facebook.com/Kaltura/', 'https://www.facebook.com/Karnavati.Uni/', 'https://www.facebook.com/KavyaPublications/', 'https://www.facebook.com/Kgbuilders38/', 'https://www.facebook.com/Kidzee-Preschool-and-Activity-Centre-597859580073301/', 'https://www.facebook.com/Kotak811DigitalBank/', 'https://www.facebook.com/KotakBank/', 'https://www.facebook.com/Kredily/', 'https://www.facebook.com/LPUUniversity/', 'https://www.facebook.com/LSBFSingaporeCampus/', 'https://www.facebook.com/LaBelleIndia/', 'https://www.facebook.com/LaveenaAshishDance/', 'https://www.facebook.com/LeadershipBooksOnline/', 'https://www.facebook.com/Lenskartindia/', 'https://www.facebook.com/LetUsAllRise/', 'https://www.facebook.com/LetsEnterprise/', 'https://www.facebook.com/LexlegisAI/', 'https://www.facebook.com/LifegurukulOfficial/']


phone_list = set()
chunk_size = 100
semaphore = asyncio.Semaphore(8)

# Load existing numbers from CSV to prevent duplicates
if os.path.exists("phones.csv"):
    with open("phones.csv", newline="") as f:
        reader = csv.reader(f)
        phone_list.update(row[0] for row in reader)

async def process_url(browser, url):
    async with semaphore:
        page = await browser.new_page()
        try:
            await page.goto(url)
            try:
                await page.click("div[aria-label='Close']", timeout=3000)
            except:
                pass
            await page.wait_for_selector("div[role='main']")
            await page.wait_for_timeout(3000)
            phone_element = page.locator("text=/\\+?[0-9][0-9\\-\\s]{8,}/").first
            if await phone_element.count() > 0:
                raw = await phone_element.inner_text()
                cleaned = raw.replace(" ", "")
                if cleaned not in phone_list:
                    phone_list.add(cleaned)
                    with open("phones.csv", "a", newline="") as f:
                        writer = csv.writer(f)
                        writer.writerow([cleaned])
        except:
            pass
        finally:
            await page.close()
            LIST.remove(url)

async def go():
    async with async_playwright() as p:
        browser = await p.chromium.launch(headless=False)
        tasks = [process_url(browser, url) for url in LIST[:chunk_size]]
        await asyncio.gather(*tasks)
        await browser.close()

asyncio.run(go())
